<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Nokia Snake — Classic</title>

  <style>
    :root{
      --bg:#0c2a12;
      --grid:#a7ff7f;
      --panel:#07160b;
      --accent:#c5ffd0;
    }
    html,body{height:100%;margin:0;font-family:system-ui,Roboto,Arial}
    body{display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,var(--bg),#04130a);color:var(--accent)}
    .wrap{width:min(720px,95vw);max-width:720px;background:var(--panel);border-radius:12px;padding:18px;box-shadow:0 8px 30px rgba(0,0,0,.6);}
    header{display:flex;align-items:center;gap:12px;margin-bottom:12px}
    .title{font-weight:700;font-size:1.15rem}
    canvas{display:block;width:100%;height:auto;background:#001408;border-radius:8px;image-rendering:pixelated}
    .controls{display:flex;gap:8px;align-items:center;margin-top:10px}
    .btn{background:transparent;border:1px solid #20421b;color:var(--accent);padding:8px 10px;border-radius:8px;font-weight:600;cursor:pointer}
    .info{margin-left:auto;text-align:right}
    .small{font-size:.85rem;color:#9fd8a8}
    .score{font-size:1.05rem;font-weight:700}
    .footer{margin-top:10px;color:#7fbf88;font-size:.86rem}
    .mobile-hint{display:none;margin-top:8px;color:#9fd8a8}
    @media (max-width:600px){.wrap{padding:12px}.mobile-hint{display:block}}
  </style>
</head>

<body>
  <div class="wrap">
    <header>
      <div class="title">Nokia Snake — Classic</div>
      <div class="info">
        <div class="small">Controls: Arrow keys / WASD / Swipe</div>
        <div class="score" id="score">Score: 0</div>
      </div>
    </header>

    <canvas id="game" width="320" height="320"></canvas>

    <div class="controls">
      <button class="btn" id="start">Start</button>
      <button class="btn" id="pause">Pause</button>
      <button class="btn" id="reset">Reset</button>
      <label style="margin-left:8px;color:#9fd8a8">Speed</label>
      <input id="speed" type="range" min="4" max="16" value="8" style="width:140px"/>
      <div style="margin-left:auto;color:#9fd8a8">Highscore: <span id="high">0</span></div>
    </div>

    <div class="mobile-hint">Tip: Swipe to move • Tap to pause</div>
    <div class="footer">Made for you — enjoy!</div>
  </div>

<script>
//==================== SNAKE GAME ====================//
(() => {
  const canvas = document.getElementById("game");
  const ctx = canvas.getContext("2d");

  const GRID = 20;
  const CELL = canvas.width / GRID;

  const BG = "#001408";
  const PIX = "#A7FF7F";
  const SNAKE_HEAD = "#cfffad";

  // Game State
  let snake = [{x:9,y:9},{x:8,y:9},{x:7,y:9}];
  let dir = {x:1,y:0};
  let nextDir = {x:1,y:0};
  let food = spawnFood();
  let running = false;
  let score = 0;

  let high = Number(localStorage.getItem("nokia_snake_high") || 0);
  document.getElementById("high").innerText = high;

  // Speed
  const speedEl = document.getElementById("speed");
  let speed = Number(speedEl.value);
  speedEl.addEventListener("input",()=> speed = Number(speedEl.value));

  //=========== INPUT ===========//
  window.addEventListener("keydown", e => {
    if (e.key==="ArrowUp"||e.key==="w") tryTurn(0,-1);
    if (e.key==="ArrowDown"||e.key==="s") tryTurn(0,1);
    if (e.key==="ArrowLeft"||e.key==="a") tryTurn(-1,0);
    if (e.key==="ArrowRight"||e.key==="d") tryTurn(1,0);
    if (e.key===" ") togglePause();
  });

  function tryTurn(x,y){
    if (x === -dir.x && y === -dir.y) return;
    nextDir = {x,y};
  }

  // ========== MOBILE SWIPE ========== //
  let touchStart = null;
  canvas.addEventListener("touchstart", e=>{
    if(e.touches.length===1)
      touchStart = {x:e.touches[0].clientX, y:e.touches[0].clientY};
  },{passive:true});

  canvas.addEventListener("touchend", e=>{
    if(!touchStart) return;

    const t = e.changedTouches[0];
    const dx = t.clientX - touchStart.x;
    const dy = t.clientY - touchStart.y;

    if (Math.abs(dx) < 20 && Math.abs(dy) < 20) togglePause();
    else if (Math.abs(dx) > Math.abs(dy))
      tryTurn(dx>0?1:-1,0);
    else
      tryTurn(0,dy>0?1:-1);

    touchStart = null;
  },{passive:true});


  //=========== MAIN LOOP ===========//
  let lastFrame=0,acc=0;

  function loop(ts){
    if(!lastFrame) lastFrame = ts;
    const dt = (ts-lastFrame)/1000;
    lastFrame = ts;

    if(running){
      acc += dt;
      const interval = 1/speed;
      while(acc >= interval){
        tick();
        acc -= interval;
      }
    }

    render();
    requestAnimationFrame(loop);
  }
  requestAnimationFrame(loop);


  //=========== TICK ===========//
  function tick(){
    dir = nextDir;
    const head = {
      x: (snake[0].x + dir.x + GRID) % GRID,
      y: (snake[0].y + dir.y + GRID) % GRID
    };

    snake.unshift(head);

    if (head.x === food.x && head.y === food.y){
      score += 10;
      document.getElementById("score").innerText = "Score: " + score;
      food = spawnFood();
      if(score % 50 === 0){ speed = Math.min(20,speed+1); speedEl.value = speed; }
    } else {
      snake.pop();
    }
  }

  //=========== FOOD ===========//
  function spawnFood(){
    let free = [];
    for(let x=0;x<GRID;x++)
      for(let y=0;y<GRID;y++)
        if(!snake.some(s=>s.x===x&&s.y===y)) free.push({x,y});
    return free[Math.floor(Math.random()*free.length)];
  }

  //=========== DRAWING ===========//
  function render(){
    ctx.fillStyle = BG;
    ctx.fillRect(0,0,canvas.width,canvas.height);

    drawLadybug(food.x, food.y);


    for(let i=snake.length-1; i>=0; i--){
      if(i===0) drawSnakeHead(snake[i].x, snake[i].y);
      else drawCell(snake[i].x, snake[i].y, PIX);
    }
  }

  function drawCell(x,y,color){
    ctx.fillStyle = color;
    ctx.fillRect(x*CELL+2, y*CELL+2, CELL-4, CELL-4);
  }

  //=========== REAL SNAKE HEAD ===========//
  function drawSnakeHead(x,y){
    const px = x*CELL, py = y*CELL;

    // Head block
    ctx.fillStyle = SNAKE_HEAD;
    ctx.fillRect(px+1, py+1, CELL-2, CELL-2);

    // Eyes
    ctx.fillStyle = "#000";
    const eye = 2;
    if(dir.x!==0){
      ctx.fillRect(px+(dir.x>0?CELL-6:4), py+4, eye, eye);
      ctx.fillRect(px+(dir.x>0?CELL-6:4), py+CELL-6, eye, eye);
    } else {
      ctx.fillRect(px+4, py+(dir.y>0?CELL-6:4), eye, eye);
      ctx.fillRect(px+CELL-6, py+(dir.y>0?CELL-6:4), eye, eye);
    }

    // Tongue
    ctx.fillStyle = "#ff4a4a";
    if(dir.x===1) ctx.fillRect(px+CELL-2, py+CELL/2-1, 3,2);
    if(dir.x===-1) ctx.fillRect(px-1, py+CELL/2-1, 3,2);
    if(dir.y===1) ctx.fillRect(px+CELL/2-1, py+CELL-2, 2,3);
    if(dir.y===-1) ctx.fillRect(px+CELL/2-1, py-1, 2,3);
  }

  //=========== Ladybug FOOD ===========//
  function drawLadybug(x, y) {
  const px = x * CELL;
  const py = y * CELL;

  // Body
  ctx.fillStyle = "#d62828"; // ladybug red
  ctx.beginPath();
  ctx.arc(px + CELL/2, py + CELL/2, CELL/3, 0, Math.PI * 2);
  ctx.fill();

  // Black head
  ctx.fillStyle = "#000";
  ctx.beginPath();
  ctx.arc(px + CELL/2, py + CELL/2 - 6, CELL/6, 0, Math.PI * 2);
  ctx.fill();

  // Black spots
  ctx.beginPath();
  ctx.arc(px + CELL/2 - 4, py + CELL/2, 2, 0, Math.PI * 2);
  ctx.arc(px + CELL/2 + 4, py + CELL/2, 2, 0, Math.PI * 2);
  ctx.arc(px + CELL/2 - 2, py + CELL/2 + 4, 2, 0, Math.PI * 2);
  ctx.arc(px + CELL/2 + 2, py + CELL/2 + 4, 2, 0, Math.PI * 2);
  ctx.fill();

  // Center line
  ctx.strokeStyle = "#000";
  ctx.lineWidth = 1;
  ctx.beginPath();
  ctx.moveTo(px + CELL/2, py + CELL/2 - 6);
  ctx.lineTo(px + CELL/2, py + CELL/2 + 6);
  ctx.stroke();
}


  //=========== BUTTONS ===========//
  document.getElementById("start").onclick = ()=> running=true;
  document.getElementById("pause").onclick = togglePause;
  document.getElementById("reset").onclick = resetGame;

  function togglePause(){ running = !running; }

  function resetGame(){
    snake=[{x:9,y:9},{x:8,y:9},{x:7,y:9}];
    dir={x:1,y:0}; nextDir={x:1,y:0};
    food = spawnFood();
    score = 0;
    document.getElementById("score").innerText="Score: 0";
    running=false;
  }

  resetGame();
})();
</script>

</body>
</html>
